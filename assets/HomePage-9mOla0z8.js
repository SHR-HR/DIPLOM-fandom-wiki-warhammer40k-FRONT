import{c as m,u as x,a as h,r as b,j as e,s as f,b as g,d as j,L as v,f as w,S as N}from"./index-C_2_JlYQ.js";import{p as k,n as _,o as A,P as I}from"./imgProxy-BVyZ5yvB.js";const C=m("Book",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]]);const S=m("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);const z=m("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);const M=m("ImageOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M10.41 10.41a2 2 0 1 1-2.83-2.83",key:"1bzlo9"}],["line",{x1:"13.5",x2:"6",y1:"13.5",y2:"21",key:"1q0aeu"}],["line",{x1:"18",x2:"21",y1:"12",y2:"15",key:"5mozeu"}],["path",{d:"M3.59 3.59A1.99 1.99 0 0 0 3 5v14a2 2 0 0 0 2 2h14c.55 0 1.052-.22 1.41-.59",key:"mmje98"}],["path",{d:"M21 15V5a2 2 0 0 0-2-2H9",key:"43el77"}]]);const L=m("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);const p=m("Skull",[["path",{d:"m12.5 17-.5-1-.5 1h1z",key:"3me087"}],["path",{d:"M15 22a1 1 0 0 0 1-1v-1a2 2 0 0 0 1.56-3.25 8 8 0 1 0-11.12 0A2 2 0 0 0 8 20v1a1 1 0 0 0 1 1z",key:"1o5pge"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}]]);function P(){const{search:s,limit:a}=x(r=>r.ui),t=h(),l=b.useId();return e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx("label",{htmlFor:l,className:"sr-only",children:"Поиск по заголовкам"}),e.jsx(L,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{id:l,name:"q",type:"search",autoComplete:"off",className:`
          w-full pl-10 pr-4 py-2 rounded-lg border outline-none transition
          bg-white text-gray-900 placeholder-gray-400
          focus:ring-2 focus:ring-brass focus:border-transparent
          dark:bg-gray-900 dark:text-white dark:border-gray-700
        `,placeholder:"Поиск по заголовкам...",value:s,onChange:r=>{t(f(r.target.value)),t(g({start:0,limit:a}))}})]})}const E=[{value:"new",label:"Сначала новые"},{value:"old",label:"Сначала старые"},{value:"az",label:"A → Z (заголовок)"},{value:"za",label:"Z → A (заголовок)"},{value:"author",label:"Автор A → Z"}];function q(){const s=x(t=>t.ui.sort),a=h();return e.jsxs("div",{className:"w-full sm:w-auto",children:[e.jsx("label",{className:"sr-only",htmlFor:"sort",children:"Сортировка"}),e.jsx("div",{className:"sort-wrap w-full sm:w-56",children:e.jsx("select",{id:"sort",value:s,onChange:t=>a(j(t.target.value)),className:"sort-select w-full",children:E.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))})})]})}function H(){const{start:s,limit:a}=x(d=>d.ui),{total:t}=x(d=>d.articles),l=h(),r=t,o=s+a<r,c=Math.min(s+a,Math.max(r,0)),i=s>0;return r<=a&&s===0?null:e.jsxs("div",{className:"flex items-center gap-4 justify-center",children:[e.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 bg-gray-800 hover:bg-brass hover:text-black border border-brass rounded-lg transition disabled:opacity-50 disabled:cursor-not-allowed",onClick:()=>l(g({start:Math.max(0,s-a),limit:a})),disabled:!i,"aria-label":"Предыдущая страница",children:[e.jsx(S,{className:"w-4 h-4"}),"Назад"]}),e.jsxs("span",{className:"text-gray-400",children:["Статьи ",r===0?0:s+1,"—",c," из ",r]}),e.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 bg-gray-800 hover:bg-brass hover:text-black border border-brass rounded-lg transition disabled:opacity-50 disabled:cursor-not-allowed",onClick:()=>l(g({start:s+a,limit:a})),disabled:!o,"aria-label":"Следующая страница",children:["Вперед",e.jsx(z,{className:"w-4 h-4"})]})]})}function F({article:s}){const[a,t]=b.useState(!1),l=k(s.previewImg),r=_(l);return e.jsxs(v,{to:`/article/${s.id}`,className:"group block rounded-2xl border-2 border-brass overflow-hidden bg-black dark:bg-black light:bg-white hover:scale-105 hover:shadow-[0_0_30px_rgba(180,141,87,0.4)] transition-all duration-300 gothic-border shadow-lg",children:[e.jsxs("div",{className:"aspect-video overflow-hidden bg-gradient-to-br from-gray-900 to-black dark:from-gray-900 dark:to-black light:from-gray-200 light:to-gray-300 relative",children:[e.jsx("img",{src:l,"data-original":s.previewImg||"",alt:s.title,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-500 opacity-80 group-hover:opacity-100",loading:"lazy",referrerPolicy:"no-referrer",onError:A,onLoad:o=>{const c=o.currentTarget;t(c.src===I)},...r?{crossOrigin:"anonymous"}:{}}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black via-transparent to-transparent opacity-60"}),a&&e.jsxs("div",{className:"pointer-events-none absolute inset-0 flex flex-col items-center justify-center text-brass",children:[e.jsx(M,{className:"w-16 h-16 mb-2 opacity-50"}),e.jsx("span",{className:"text-sm opacity-75",children:"Изображение недоступно"})]})]}),e.jsx("div",{className:"p-4 bg-gradient-to-b from-gray-950 to-black dark:from-gray-950 dark:to-black light:from-gray-50 light:to-gray-100",children:e.jsx("h3",{className:"font-bold text-lg text-brass group-hover:text-yellow-400 transition tracking-wide drop-shadow-[0_0_10px_rgba(180,141,87,0.5)]",children:s.title})})]})}function O({articles:s}){return s.length===0?e.jsx("div",{className:"text-center py-20",children:e.jsx("p",{className:"text-2xl text-gray-400",children:"Статьи не найдены"})}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 sm:gap-6",children:s.map(a=>e.jsx(F,{article:a},a.id))})}function B(){const s=h(),{list:a,loading:t,error:l,total:r}=x(n=>n.articles),{search:o,start:c,limit:i,sort:d}=x(n=>n.ui),u=n=>{switch(n){case"new":return{sort:"id",dir:"desc"};case"old":return{sort:"id",dir:"asc"};case"az":return{sort:"title",dir:"asc"};case"za":return{sort:"title",dir:"desc"};case"author":return{sort:"author",dir:"asc"};default:return{}}};return b.useEffect(()=>{const{sort:n,dir:y}=u(d);s(w({start:c,limit:i,q:o||void 0,sort:n,dir:y}))},[s,c,i,o,d]),e.jsxs("div",{className:"container mx-auto px-3 sm:px-4 md:px-6 py-4 sm:py-6 md:py-8 space-y-6 sm:space-y-8",children:[e.jsxs("section",{className:"rounded-xl sm:rounded-2xl border-2 border-brass bg-gradient-to-br from-black via-gray-900 to-black p-6 sm:p-8 md:p-12 text-center gothic-border relative overflow-hidden shadow-2xl",children:[e.jsxs("div",{className:"absolute inset-0 opacity-20",children:[e.jsx("div",{className:"absolute top-10 left-10 animate-pulse",children:e.jsx(p,{className:"w-32 h-32 text-brass"})}),e.jsx("div",{className:"absolute bottom-10 right-10 animate-pulse",style:{animationDelay:"1s"},children:e.jsx(p,{className:"w-32 h-32 text-mech"})}),e.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 opacity-10",children:e.jsx(p,{className:"w-64 h-64 text-gray-800"})})]}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 sm:gap-4 mb-4 sm:mb-6",children:[e.jsx(N,{className:"w-10 h-10 sm:w-12 md:w-16 sm:h-12 md:h-16 text-brass animate-pulse drop-shadow-[0_0_15px_rgba(180,141,87,0.6)]"}),e.jsx("h1",{className:"text-2xl sm:text-3xl md:text-4xl lg:text-5xl font-bold text-brass imperial-aquila tracking-wider drop-shadow-[0_0_20px_rgba(180,141,87,0.8)]",children:"FANDOM WIKI"}),e.jsx(C,{className:"w-10 h-10 sm:w-12 md:w-16 sm:h-12 md:h-16 text-brass animate-pulse drop-shadow-[0_0_15px_rgba(180,141,87,0.6)]"})]}),e.jsx("h2",{className:"text-xl sm:text-2xl md:text-3xl font-bold mb-3 sm:mb-4 text-transparent bg-clip-text bg-gradient-to-r from-brass via-yellow-300 to-brass drop-shadow-[0_0_15px_rgbа(180,141,87,0.5)]",children:"WARHAMMER 40,000"}),e.jsx("p",{className:"max-w-3xl mx-auto text-sm sm:text-base md:text-lg leading-relaxed px-4 text-white/80 dark:text-white/80 drop-shadow-[0_2px_4px_rgba(0,0,0,0.8)]",children:"Фанатская энциклопедия персонажей, легионов и событий легендарной вселенной Warhammer 40k."}),e.jsx("p",{className:"text-mech font-bold text-base sm:text-lg md:text-xl mt-3 sm:mt-4 tracking-widest drop-shadow-[0_0_10px_rgba(193,18,31,0.6)]",children:"«В мрачной тьме далекого будущего есть только война»"})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-stretch sm:items-center",children:[e.jsx("div",{className:"flex-1 flex gap-4",children:e.jsx(P,{})}),e.jsx(q,{})]}),t?e.jsxs("div",{className:"text-center py-20",children:[e.jsx("div",{className:"inline-block w-12 h-12 border-4 border-brass border-t-transparent rounded-full animate-spin"}),e.jsx("p",{className:"mt-4 text-gray-400",children:"Загрузка статей…"})]}):l?e.jsxs("div",{className:"text-center py-16",children:[e.jsxs("p",{className:"text-red-400 font-semibold",children:["Ошибка: ",l]}),e.jsx("p",{className:"text-gray-400 mt-2",children:"Обнови страницу или перезапусти API."})]}):a.length===0?e.jsx("div",{className:"text-center py-16",children:o.trim()?e.jsxs("p",{className:"text-gray-400",children:["По запросу «",o,"» ничего не найдено."]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-gray-400",children:"Статей нет."}),e.jsxs("p",{className:"text-gray-500 text-sm mt-2",children:["Проверь, что API запущен и файл ",e.jsx("code",{children:"data/articles.json"})," содержит записи."]})]})}):e.jsxs(e.Fragment,{children:[e.jsx(O,{articles:a}),(r>i||a.length>=i)&&e.jsx(H,{})]})]})}export{B as default};
