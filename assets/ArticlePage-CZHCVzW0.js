import{c as h,j as e,U as k,e as f,r as p,a as j,u as m,g as b,L as y}from"./index-C_2_JlYQ.js";import{S as x}from"./SmartImg-X6HPvToj.js";import{p as u,n as N}from"./imgProxy-BVyZ5yvB.js";const v=h("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);const w=h("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);const M=h("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);const A=h("Ruler",[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]]);const g=h("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);const L=h("VenetianMask",[["path",{d:"M2 12a5 5 0 0 0 5 5 8 8 0 0 1 5 2 8 8 0 0 1 5-2 5 5 0 0 0 5-5V7h-5a8 8 0 0 0-5 2 8 8 0 0 0-5-2H2Z",key:"1g6z3j"}],["path",{d:"M6 11c1.5 0 3 .5 3 2-2 0-3 0-3-2Z",key:"c2lwnf"}],["path",{d:"M18 11c-1.5 0-3 .5-3 2 2 0 3 0 3-2Z",key:"njd9zo"}]]);const S=h("Weight",[["circle",{cx:"12",cy:"5",r:"3",key:"rqqgnr"}],["path",{d:"M6.5 8a2 2 0 0 0-1.905 1.46L2.1 18.5A2 2 0 0 0 4 21h16a2 2 0 0 0 1.925-2.54L19.4 9.5A2 2 0 0 0 17.48 8Z",key:"56o5sh"}]]),I=[{key:"name",label:"Имя",icon:e.jsx(k,{className:"w-4 h-4"})},{key:"age",label:"Возраст",icon:e.jsx(g,{className:"w-4 h-4"})},{key:"birthday",label:"День рождения",icon:e.jsx(w,{className:"w-4 h-4"})},{key:"gender",label:"Пол",icon:e.jsx(L,{className:"w-4 h-4"})},{key:"appearance",label:"Внешность",icon:e.jsx(g,{className:"w-4 h-4"})},{key:"height",label:"Рост",icon:e.jsx(A,{className:"w-4 h-4"})},{key:"weight",label:"Вес",icon:e.jsx(S,{className:"w-4 h-4"})}];function z({blocks:n}){return n?.length?e.jsx("div",{className:"space-y-6",children:n.map((t,i)=>{if(t.type==="image"){const c=t.src??(typeof t.content=="string"?t.content:void 0),a=c?u(c):void 0;return a?e.jsx(x,{original:c,src:a,variant:"content",fit:"contain",className:"select-none",framed:!0},i):null}if(t.type==="ul"&&Array.isArray(t.content)){const c=t.content.map(a=>typeof a=="string"?a:a?.content??"").map(a=>a.trim()).filter(Boolean);return e.jsx("ul",{className:"list-disc pl-5 space-y-2 text-gray-800 dark:text-gray-300",children:c.length>0?c.map((a,l)=>e.jsx("li",{children:a},l)):null},i)}return t.type==="h1"?e.jsx("h1",{className:"text-3xl sm:text-4xl font-extrabold tracking-tight text-gray-900 dark:text-brass text-glow-brass",children:String(t.content??"")},i):t.type==="h2"?e.jsx("h2",{className:"text-2xl sm:text-3xl font-extrabold tracking-tight text-gray-900 dark:text-brass text-glow-brass",children:String(t.content??"")},i):e.jsx("p",{className:"leading-relaxed text-gray-800 dark:text-gray-300",children:String(t.content??"")},i)})}):null}function C({article:n}){const t=n.mainInfo,i=u(n.previewImg),c=N(i),a=I.map(({key:l,label:o,icon:r})=>{const d=t?.[l];if(d==null||d==="")return null;let s=String(d);return l==="height"&&/^\d+$/.test(s)&&(s+=" см"),l==="weight"&&/^\d+$/.test(s)&&(s+=" кг"),{label:o,value:s,icon:r}}).filter(Boolean);return e.jsxs("div",{className:"space-y-6",children:[e.jsx(x,{original:n.previewImg,src:i,variant:"hero",fit:"cover",framed:!0,radiusClass:"rounded-2xl",...c?{crossOrigin:"anonymous"}:{},alt:n.title,className:"!rounded-none"}),e.jsxs("section",{className:"rounded-2xl border-2 border-brass p-6 bg-white/95 text-gray-800 dark:bg-gray-900 dark:text-gray-200",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-brass mb-4 text-glow-brass",children:"Главная информация"}),e.jsxs("div",{className:`grid md:grid-cols-2 gap-6 ${t?.image?"":"md:grid-cols-1"}`,children:[t?.image&&e.jsx(x,{original:t.image,variant:"content",fit:"contain",framed:!0,className:"select-none",alt:""}),e.jsx("div",{className:"kv-card",children:a.length===0?e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Нет данных для отображения."}):e.jsx("dl",{className:"kv-grid",children:a.map(({label:l,value:o,icon:r},d)=>e.jsxs("div",{className:"kv-row",children:[e.jsxs("dt",{className:"kv-label",children:[r,l]}),e.jsx("dd",{className:"kv-value",children:o})]},d))})})]})]}),e.jsx("section",{className:"rounded-2xl border-2 border-brass p-6 bg-white/95 dark:bg-gray-900",children:e.jsx(z,{blocks:n.mainContent??[]})})]})}const E={};function D(){const{id:n}=f(),t=p.useMemo(()=>{const s=Number(n);return Number.isFinite(s)?s:NaN},[n]),i=j(),c=m(s=>s.auth.isAuthed),a=m(s=>s.auth.me),l=m(s=>s.articles.byId[t]),o=E[t],r=l??o;p.useEffect(()=>{Number.isFinite(t)&&(o||l||i(b(t)))},[t,o,l,i]);const d=!!(c&&a&&r&&typeof r.author_id=="number"&&a.id===r.author_id);return Number.isFinite(t)?r?e.jsxs("div",{className:"container mx-auto px-4 py-8 space-y-6",children:[e.jsxs("header",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs(y,{to:"/",className:"inline-flex items-center gap-2 text-brass hover:text-yellow-400 transition mb-2",children:[e.jsx(v,{className:"w-4 h-4"}),"Назад к списку"]}),e.jsx("h1",{className:"text-3xl font-bold text-brass",children:r.title}),r.author&&e.jsxs("p",{className:"text-gray-400 text-sm mt-1",children:["Автор: ",r.author]})]}),d&&e.jsxs(y,{to:`/edit/${r.id}`,className:`
              inline-flex items-center gap-2 px-4 py-2
              rounded-lg border-2 border-brass
            bg-black text-white
            hover:bg-brass hover:text-black
              transition
            `,title:"Редактировать статью",children:[e.jsx(M,{className:"w-4 h-4"}),"Редактировать"]})]}),e.jsx(C,{article:r})]}):e.jsxs("div",{className:"container mx-auto px-4 py-8 text-center",children:[e.jsx("div",{className:"inline-block w-12 h-12 border-4 border-brass border-t-transparent rounded-full animate-spin"}),e.jsx("p",{className:"mt-4 text-gray-400",children:"Загрузка статьи…"})]}):e.jsx("div",{className:"container mx-auto px-4 py-8 text-center text-gray-400",children:"Неверный идентификатор статьи"})}export{D as default};
