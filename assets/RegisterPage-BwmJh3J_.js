import{c as _,h as A,a as D,r as t,j as e,S as M,U as v,C as q,L as T,D as U,z,n as k,A as R}from"./index-C_2_JlYQ.js";import{L as C}from"./lock-CUP9RJPH.js";import{E as P}from"./eye-Dgucr8zC.js";import{o as O,s as d,l as Z}from"./types-CB9iKTr5.js";const S=_("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);const V=_("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),B=O({name:d().min(2,"Имя должно содержать минимум 2 символа").max(50,"Имя должно содержать максимум 50 символов"),login:d().min(3,"Логин должен содержать минимум 3 символа").max(20,"Логин должен содержать максимум 20 символов").regex(/^[a-zA-Z0-9_]+$/,"Логин может содержать только латинские буквы, цифры и _"),email:d().email("Некорректный email").optional().or(Z("").transform(()=>{})),password:d().min(3,"Пароль должен содержать минимум 3 символа").regex(/[A-Za-z]/,"Пароль должен содержать латинские буквы").regex(/[0-9]/,"Пароль должен содержать цифры"),confirmPassword:d()}).refine(x=>x.password===x.confirmPassword,{message:"Пароли не совпадают",path:["confirmPassword"]});function Q(){const x=A(),I=D(),g=t.useId(),b=t.useId(),f=t.useId(),w=t.useId(),y=t.useId(),[j,N]=t.useState(!1),[u,E]=t.useState(!1),[h,L]=t.useState(!1),[a,F]=t.useState({name:"",login:"",email:"",password:"",confirmPassword:""}),[s,m]=t.useState({}),c=l=>{const{name:i,value:o}=l.target;F(r=>({...r,[i]:o})),s[i]&&m(r=>({...r,[i]:""}))},$=async l=>{l.preventDefault(),m({});const i=B.safeParse(a);if(!i.success){const o={};i.error.errors.forEach(r=>{const n=r.path[0];n&&(o[n]=r.message)}),m(o);return}N(!0);try{await U({name:a.name,login:a.login,password:a.password,email:a.email||void 0}),await I(z({username:a.login,password:a.password,remember:!0})).unwrap(),k.success(`Добро пожаловать, ${a.name}!`);const o=R();x(o||"/profile",{replace:!0})}catch(o){const r=String(o?.response?.data?.detail||o?.message||"Ошибка регистрации");k.error(r);const n=r.toLowerCase();(n.includes("логин")||n.includes("login"))&&m(p=>({...p,login:r})),(n.includes("email")||n.includes("почт"))&&m(p=>({...p,email:r}))}finally{N(!1)}};return e.jsx("div",{className:"min-h-[calc(100vh-16rem)] flex items-center justify-center px-3 sm:px-4 py-8",children:e.jsx("div",{className:"w-full max-w-md",children:e.jsxs("div",{className:"rounded-xl sm:rounded-2xl border-2 border-brass bg-gray-900 p-6 sm:p-8 shadow-[0_0_30px_rgba(180,141,87,0.3)]",children:[e.jsxs("div",{className:"text-center mb-6 sm:mb-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 sm:w-20 sm:h-20 rounded-full bg-brass/10 border-2 border-brass mb-4",children:e.jsx(M,{className:"w-8 h-8 sm:w-10 sm:h-10 text-brass"})}),e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-brass mb-2",children:"Регистрация"}),e.jsx("p",{className:"text-gray-400 text-sm sm:text-base",children:"Присоединяйтесь к Империуму Человечества"})]}),e.jsxs("form",{onSubmit:$,className:"space-y-4 sm:space-y-5",noValidate:!0,children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:g,className:"block text-gray-300 text-sm font-medium mb-2",children:[e.jsx(v,{className:"w-4 h-4 inline mr-2"}),"Имя"]}),e.jsx("input",{id:g,type:"text",name:"name",autoComplete:"name",value:a.name,onChange:c,"aria-invalid":!!s.name,className:`w-full px-4 py-3 rounded-lg bg-gray-800 border ${s.name?"border-mech":"border-gray-700"} text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-brass transition`,placeholder:"Ваше имя",required:!0}),s.name&&e.jsx("p",{className:"mt-1 text-xs text-mech",children:s.name})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:b,className:"block text-gray-300 text-sm font-medium mb-2",children:[e.jsx(v,{className:"w-4 h-4 inline mr-2"}),"Логин"]}),e.jsx("input",{id:b,type:"text",name:"login",autoComplete:"username",value:a.login,onChange:c,"aria-invalid":!!s.login,className:`w-full px-4 py-3 rounded-lg bg-gray-800 border ${s.login?"border-mech":"border-gray-700"} text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-brass transition`,placeholder:"Логин для входа (латиница, цифры, _)",required:!0}),s.login&&e.jsx("p",{className:"mt-1 text-xs text-mech",children:s.login})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:f,className:"block text-gray-300 text-sm font-medium mb-2",children:[e.jsx(V,{className:"w-4 h-4 inline mr-2"}),"Email (необязателен)"]}),e.jsx("input",{id:f,type:"email",name:"email",autoComplete:"email",value:a.email,onChange:c,"aria-invalid":!!s.email,className:`w-full px-4 py-3 rounded-lg bg-gray-800 border ${s.email?"border-mech":"border-gray-700"} text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-brass transition`,placeholder:"your@email.com"}),s.email&&e.jsx("p",{className:"mt-1 text-xs text-mech",children:s.email})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:w,className:"block text-gray-300 text-sm font-medium mb-2",children:[e.jsx(C,{className:"w-4 h-4 inline mr-2"}),"Пароль"]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:w,type:u?"text":"password",name:"password",autoComplete:"new-password",value:a.password,onChange:c,"aria-invalid":!!s.password,className:`w-full px-4 py-3 rounded-lg bg-gray-800 border ${s.password?"border-mech":"border-gray-700"} text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-brass transition pr-12`,placeholder:"Минимум 3 символа, буквы + цифры",required:!0}),e.jsx("button",{type:"button",onClick:()=>E(l=>!l),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-brass transition","aria-label":u?"Скрыть пароль":"Показать пароль",children:u?e.jsx(S,{className:"w-5 h-5"}):e.jsx(P,{className:"w-5 h-5"})})]}),s.password&&e.jsx("p",{className:"mt-1 text-xs text-mech",children:s.password})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:y,className:"block text-gray-300 text-sm font-medium mb-2",children:[e.jsx(C,{className:"w-4 h-4 inline mr-2"}),"Подтвердите пароль"]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:y,type:h?"text":"password",name:"confirmPassword",autoComplete:"new-password",value:a.confirmPassword,onChange:c,"aria-invalid":!!s.confirmPassword,className:`w-full px-4 py-3 rounded-lg bg-gray-800 border ${s.confirmPassword?"border-mech":"border-gray-700"} text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-brass transition pr-12`,placeholder:"Повторите пароль",required:!0}),e.jsx("button",{type:"button",onClick:()=>L(l=>!l),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-brass transition","aria-label":h?"Скрыть подтверждение":"Показать подтверждение",children:h?e.jsx(S,{className:"w-5 h-5"}):e.jsx(P,{className:"w-5 h-5"})})]}),s.confirmPassword&&e.jsx("p",{className:"mt-1 text-xs text-mech",children:s.confirmPassword})]}),e.jsx("button",{type:"submit",disabled:j,className:"w-full py-3 sm:py-4 bg-brass hover:bg-yellow-600 text-black font-bold rounded-lg transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 shadow-[0_0_20px_rgba(180,141,87,0.4)] hover:shadow-[0_0_30px_rgba(180,141,87,0.6)]",children:j?e.jsx("div",{className:"w-5 h-5 border-2 border-black border-t-transparent rounded-full animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"w-5 h-5"})," Зарегистрироваться"]})})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("p",{className:"text-gray-400 text-sm",children:["Уже есть аккаунт?"," ",e.jsx(T,{to:"/profile",className:"text-brass hover:text-yellow-400 font-medium transition",children:"Войти"})]})})]})})})}export{Q as default};
